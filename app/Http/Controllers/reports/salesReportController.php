<?php
 namespace App\Http\Controllers\reports; use App\Http\Controllers\Controller; use App\Models\accounts; use App\Models\sales; use Illuminate\Http\Request; class salesReportController extends Controller { public function index() { return view("\162\145\160\x6f\x72\x74\x73\x2e\x73\141\x6c\x65\x73\56\151\156\144\x65\x78"); } public function data($from, $to, $type) { if ($type == "\101\x6c\x6c") { $sales = sales::with("\x63\165\163\x74\157\155\x65\x72", "\144\x65\x74\x61\151\x6c\163")->whereBetween("\x64\141\x74\145", array($from, $to))->get(); } else { $customers = accounts::where("\164\x79\160\145", "\103\165\x73\164\x6f\155\145\x72")->where("\x63\137\x74\x79\160\x65", $type)->pluck("\151\x64")->toArray(); $sales = sales::with("\x63\x75\163\164\x6f\155\145\162", "\144\145\x74\x61\x69\x6c\163")->whereIn("\143\165\163\x74\157\x6d\x65\x72\111\x44", $customers)->whereBetween("\x64\141\x74\145", array($from, $to))->get(); } foreach ($sales as $sale) { $sale->pdiscount = $sale->details->sum("\x64\x69\163\x63\x6f\x75\156\164"); } return view("\162\x65\x70\x6f\162\x74\163\x2e\163\141\154\145\x73\56\144\145\x74\141\151\x6c\163", compact("\146\162\x6f\155", "\164\x6f", "\163\x61\x6c\145\x73")); } }

<?php
 namespace App\Http\Controllers\reports; use App\Http\Controllers\Controller; use App\Models\products; use App\Models\purchase; use App\Models\purchase_details; use Illuminate\Http\Request; class purchaseProductsReportController extends Controller { public function index() { return view("\x72\x65\x70\157\x72\164\x73\x2e\x70\x75\x72\143\150\141\x73\145\120\x72\157\x64\165\x63\x74\163\56\151\156\144\145\x78"); } public function data($from, $to) { $products = products::all(); foreach ($products as $product) { $qty = purchase_details::where("\160\x72\x6f\144\x75\x63\x74\111\104", $product->id)->whereBetween("\x64\141\164\145", array($from, $to))->sum("\x71\x74\171"); $bonus = purchase_details::where("\x70\x72\157\144\x75\143\164\x49\104", $product->id)->whereBetween("\144\x61\164\x65", array($from, $to))->sum("\x62\157\156\165\163"); $product->qty = $qty; $product->bonus = $bonus; $product->price = avgPurchasePrice($from, $to, $product->id); } return view("\x72\x65\160\157\162\164\163\56\160\x75\x72\143\x68\x61\163\x65\120\x72\157\144\165\143\x74\x73\x2e\x64\145\164\141\x69\x6c\163", compact("\146\162\157\x6d", "\164\157", "\x70\x72\x6f\144\165\x63\164\163")); } }
